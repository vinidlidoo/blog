<!doctype html><html lang=en><head><meta charset=UTF-8><meta content="default-src 'self';font-src 'self' data:;frame-src platform.twitter.com giscus.app;img-src 'self' data: pub-94e31bf482a74272bb61e9559b598705.r2.dev;media-src 'self' pub-94e31bf482a74272bb61e9559b598705.r2.dev;form-action 'self' buttondown.com formspree.io;connect-src 'self';script-src 'self' platform.twitter.com giscus.app" http-equiv=Content-Security-Policy><meta content="width=device-width,initial-scale=1.0" name=viewport><meta content=https://vinidlidoo.github.io name=base><title>
vinidlidoo • From Keys to Protocols: ECDH and ECDSA (Part 2/2)</title><link href=https://vinidlidoo.github.io/img/favicon.png rel=icon type=image/png><link title="vinidlidoo - Atom Feed" href=https://vinidlidoo.github.io/atom.xml rel=alternate type=application/atom+xml><link href="https://vinidlidoo.github.io/custom_subset.css?h=0b9535a28bc3d5bf2321" rel=stylesheet><link href="https://vinidlidoo.github.io/main.css?h=045c365e19a4d50a64bb" rel=stylesheet><link href="https://vinidlidoo.github.io/css/details.css?h=8559b4e109b168c7cfa0" rel=stylesheet><link href="https://vinidlidoo.github.io/css/giscus-fix.css?h=dc895b97fbaf0f0d9908" rel=stylesheet><link href="https://vinidlidoo.github.io/css/newsletter.css?h=c872153c9c367e0bee16" rel=stylesheet><link href="https://vinidlidoo.github.io/css/contact.css?h=572915e83e02eb90c290" rel=stylesheet><link href="https://vinidlidoo.github.io/skins/indigo_ingot.css?h=d429472afbb246441b1a" rel=stylesheet><meta content="light dark" name=color-scheme><meta content="How elliptic curve math enables secure key exchange and digital signatures" name=description><meta content="How elliptic curve math enables secure key exchange and digital signatures" property=og:description><meta content="From Keys to Protocols: ECDH and ECDSA (Part 2/2)" property=og:title><meta content=article property=og:type><meta content=en_GB property=og:locale:alternate><link href=https://vinidlidoo.github.io/blog/secrets-and-signatures/ hreflang=en rel=alternate><meta content=en_GB property=og:locale:alternate><link href=https://vinidlidoo.github.io/fr/blog/secrets-and-signatures/ hreflang=fr rel=alternate><meta content=en_GB property=og:locale:alternate><link href=https://vinidlidoo.github.io/ja/blog/secrets-and-signatures/ hreflang=ja rel=alternate><meta content=https://vinidlidoo.github.io/blog/secrets-and-signatures/ property=og:url><meta content=vinidlidoo property=og:site_name><noscript><link href=https://vinidlidoo.github.io/no_js.css rel=stylesheet></noscript><script src=https://vinidlidoo.github.io/js/initializeTheme.min.js></script><script defer src=https://vinidlidoo.github.io/js/themeSwitcher.min.js></script><script src="https://vinidlidoo.github.io/js/searchElasticlunr.min.js?h=3626c0ef99daa745b31e" defer></script><body><a href=#main-content id=skip-link>Skip to content</a><header><nav class=navbar><div class=nav-title><a class=home-title href=https://vinidlidoo.github.io/>vinidlidoo</a></div><div class=nav-navs><ul><li><a class="nav-links no-hover-padding" href=https://vinidlidoo.github.io/blog/>blog </a><li><a class="nav-links no-hover-padding" href=https://vinidlidoo.github.io/tags/>tags </a><li><a class="nav-links no-hover-padding" href=https://vinidlidoo.github.io/contact/>contact </a><li class=menu-icons-container><ul class=menu-icons-group><li class="js menu-icon"><div aria-label="Press $SHORTCUT to open search" class="search-icon interactive-icon" title="Press $SHORTCUT to open search" id=search-button role=button tabindex=0><svg viewbox="0 -960 960 960" xmlns=http://www.w3.org/2000/svg><path d="M784-120 532-372q-30 24-69 38t-83 14q-109 0-184.5-75.5T120-580q0-109 75.5-184.5T380-840q109 0 184.5 75.5T640-580q0 44-14 83t-38 69l252 252-56 56ZM380-400q75 0 127.5-52.5T560-580q0-75-52.5-127.5T380-760q-75 0-127.5 52.5T200-580q0 75 52.5 127.5T380-400Z"/></svg></div><li class=language-switcher><details class=dropdown><summary aria-label="Language selection" title="Language selection" aria-haspopup=true role=button><div class=language-switcher-icon></div></summary> <div class=dropdown-content role=menu>English<a aria-label=Français href=https://vinidlidoo.github.io/fr/blog/secrets-and-signatures/ lang=fr role=menuitem>Français</a><a aria-label=日本語 href=https://vinidlidoo.github.io/ja/blog/secrets-and-signatures/ lang=ja role=menuitem>日本語</a></div></details><li class="theme-switcher-wrapper js"><div aria-label="Toggle dark mode" title="Toggle dark/light mode" aria-pressed=false class=theme-switcher role=button tabindex=0></div><div aria-label="Reset mode to default" class="theme-resetter arrow" title="Reset mode to default" aria-hidden=true role=button tabindex=0></div></ul></ul></div></nav></header><div class=content id=main-content><main><article class=h-entry><h1 class="p-name article-title">From Keys to Protocols: ECDH and ECDSA (Part 2/2)</h1><a class="u-url u-uid" href=https://vinidlidoo.github.io/blog/secrets-and-signatures/></a><ul class=meta><span class="hidden p-author h-card"> <a class=u-url href=https://vinidlidoo.github.io rel=author title=Vincent>Vincent</a> </span><li><time class=dt-published datetime=2026-01-19>19th Jan 2026</time><li title="904 words"><span aria-hidden=true class=separator>•</span>5 min read<li class=tag><span aria-hidden=true class=separator>•</span>Tags: <li class=tag><a class=p-category href=https://vinidlidoo.github.io/tags/crypto/>crypto</a>, <li class=tag><a class=p-category href=https://vinidlidoo.github.io/tags/math/>math</a></ul><p class=p-summary hidden>How elliptic curve math enables secure key exchange and digital signatures<section class="e-content body"><p><img alt=keys-to-protocols src=/img/keys-to-protocols.webp><p>In <a href=https://vinidlidoo.github.io/blog/math-behind-private-key/>Part 1</a>, we built up the machinery: fields, groups, elliptic curves, and the discrete logarithm problem (DLP). We ended with a key pair: pick a secret integer (I called it $n$ there; I'll use $d$ here to match standard cryptographic notation), then compute:<p>$$Q = dG$$<p>$Q$ is the public key and $d$ is the private key. The forward direction is fast, but recovering $d$ from $Q$ means solving the DLP, which is infeasible.<p>This post shows how that asymmetry enables two protocols solving different problems: <strong>ECDH</strong> for establishing shared keys, and <strong>ECDSA</strong> for digital signatures.<h2 id=ecdh-shared-keys>ECDH: Shared Keys</h2><h3 id=the-problem>The Problem</h3><p>Alice wants to send Bob a secret message. <strong>Encryption</strong> scrambles the message into ciphertext; <strong>decryption</strong> reverses the process.<p><strong>Symmetric encryption</strong> uses one key for both operations. It's fast, but it has a bootstrap problem: how does Alice send Bob that key? If she sends it over the same channel as the message, an eavesdropper intercepts both. She needs a secure channel to send the key, but that's exactly what she's trying to create. Chicken and egg.<p><strong>Asymmetric encryption</strong> could solve this: anyone can encrypt with Bob's public key, but only Bob's private key can decrypt. No secret travels over the wire. The cost? Asymmetric operations involve expensive math (point multiplications, modular exponentiations), while symmetric ciphers use simple bitwise operations. The difference in complexity is roughly 1000x.<p>The solution is a <strong>hybrid approach</strong>: use asymmetric cryptography once to establish a shared key, then switch to symmetric for the actual messages. This is exactly what ECDH does.<h3 id=the-protocol>The Protocol</h3><p><strong>Elliptic Curve Diffie-Hellman</strong> lets two parties derive a shared key over a public channel:<ol><li>Alice picks a secret integer $a$ and publishes $A = aG$<li>Bob picks a secret integer $b$ and publishes $B = bG$<li>Alice computes $S = aB = a(bG) = abG$<li>Bob computes $S = bA = b(aG) = abG$</ol><p>Both arrive at the same point $S$ without ever transmitting $a$ or $b$. Why does this work? Because $a(bG) = (ab)G = b(aG)$: the commutativity comes from integer multiplication, not any special property of the curve.<p>Why is this secure? An eavesdropper sees $A$, $B$, and $G$, but computing $abG$ from these requires solving the DLP to recover $a$ or $b$. That's the hard direction we established in Part 1.<p>What happens next: Alice and Bob hash the x-coordinate of $S$ to derive a symmetric key, then use it with a symmetric cipher like AES (the standard for same-key encryption). ECDH doesn't encrypt anything itself; it bootstraps the shared key that makes symmetric encryption possible.<sup class=footnote-reference id=fr-1-1><a href=#fn-1>1</a></sup><p>If you've used PGP or GPG with a modern key, you've used this. The hybrid structure is the same: ECDH establishes the session key, AES encrypts the message.<h2 id=ecdsa-digital-signatures>ECDSA: Digital Signatures</h2><p>ECDH solves secrecy. <strong>ECDSA</strong> (Elliptic Curve Digital Signature Algorithm) solves a different problem: authenticity.<p>Consider Ethereum transactions. They're broadcast publicly; secrecy isn't the goal. The network needs to verify that the account holder actually authorized the transaction. A <strong>digital signature</strong> proves you know the private key $d$ without revealing it, and binds that proof to a specific message.<h3 id=signing>Signing</h3><p>To sign a message $m$ with private key $d$:<ol><li>Hash the message: $z = H(m)$ (where $H$ is a hash function like SHA-256)<li>Pick a random integer $k$ (the nonce)<li>Compute $R = kG$ and extract the x-coordinate as $r$<li>Compute (where $n$ is the curve order):</ol><p>$$s = k^{-1}(z + rd) \mod n$$<p>The signature is the pair $(r, s)$.<h3 id=verification>Verification</h3><p>Given a message $m$, signature $(r, s)$, and public key $Q$:<ol><li>Compute $z = H(m)$<li>Compute $u_1 = zs^{-1} \mod n$ and $u_2 = rs^{-1} \mod n$<li>Compute $P = u_1 G + u_2 Q$<li>The signature is valid if $P$'s x-coordinate equals $r$</ol><h3 id=why-verification-works>Why Verification Works</h3><p>The verifier reconstructs $R$ without knowing $k$ or $d$. Here's the algebra:<p>$$P = u_1 G + u_2 Q = zs^{-1}G + rs^{-1}Q$$<p>Since $Q = dG$:<p>$$P = zs^{-1}G + rs^{-1}dG = s^{-1}(z + rd)G$$<p>From the signing equation, $s = k^{-1}(z + rd)$, so $s^{-1} = k/(z + rd)$. Substituting:<p>$$P = \frac{k}{z + rd}(z + rd)G = kG = R$$<p>The x-coordinate of $P$ equals $r$ precisely when the signer knew $d$.<h3 id=the-nonce>The Nonce</h3><p>The random value $k$ must be truly random and <strong>never reused</strong>. If the same $k$ signs two different messages, an attacker can algebraically recover your private key $d$. This isn't theoretical: Sony's PlayStation 3 code signing was <a href=https://en.wikipedia.org/wiki/Elliptic_Curve_Digital_Signature_Algorithm#Security>broken in 2010</a> because they used a constant $k$, allowing attackers to extract the private key and sign arbitrary code.<h2 id=takeaway>Takeaway</h2><p>One elliptic curve, one hard problem, two protocols.<p>ECDH gives you secrecy: two parties derive a shared key over a public channel, then use it for symmetric encryption. ECDSA gives you authenticity: prove you authorized something without revealing your private key.<p>This shows how the abstract group theory from Part 1 isn't just elegant mathematics. It's the foundation securing your encrypted messages, your cryptocurrency transactions, and much of the internet's infrastructure.<hr><section class=footnotes><ol class=footnotes-list><li id=fn-1><p>This works elegantly for two parties. Group chats are harder: the naive approach requires $\binom{N}{2} = \frac{N(N-1)}{2}$ pairwise key exchanges for $N$ participants. Real messaging apps use more sophisticated protocols to avoid this quadratic scaling. <a href=#fr-1-1>↩</a></p></ol></section></section><p class=credit><em>This post was written in collaboration with <a href=https://claude.ai>Claude</a>.</em><form action=https://buttondown.com/api/emails/embed-subscribe/vinidlidoo class=embeddable-buttondown-form method=post target=_blank><label for=bd-email>Get notified when I post something new.</label><input id=bd-email name=email placeholder=your@email.com type=email><input type=submit value=Subscribe></form></article></main><link href=https://vinidlidoo.github.io/katex.min.css rel=stylesheet><script defer src=https://vinidlidoo.github.io/js/katex.min.js></script><span class=hidden id=copy-success> Copied! </span><span class=hidden id=copy-init> Copy code to clipboard </span><script defer src=https://vinidlidoo.github.io/js/copyCodeToClipboard.min.js></script></div><footer><section><nav class="socials nav-navs"><ul><li><a class="nav-links no-hover-padding social" href=https://vinidlidoo.github.io/atom.xml> <img alt=feed loading=lazy src=https://vinidlidoo.github.io/social_icons/rss.svg title=feed> </a><li><a class="nav-links no-hover-padding social" rel=" me" href=https://github.com/vinidlidoo> <img alt=github loading=lazy src=https://vinidlidoo.github.io/social_icons/github.svg title=github> </a><li><a class="nav-links no-hover-padding social" rel=" me" href=https://x.com/vinidlidoo> <img alt=x loading=lazy src=https://vinidlidoo.github.io/social_icons/x.svg title=x> </a></ul></nav><nav class=nav-navs></nav><div class=credits><small> <p><p>© 2026 Vincent Ethier</p> Powered by <a href=https://www.getzola.org>Zola</a> & <a href=https://github.com/welpo/tabi>tabi</a> </small></div></section><div class="search-modal js" aria-labelledby=modalTitle id=searchModal role=dialog><h1 class=visually-hidden id=modalTitle>Search</h1><div id=modal-content><div id=searchBar><div aria-hidden=true class=search-icon><svg viewbox="0 -960 960 960" xmlns=http://www.w3.org/2000/svg><path d="M784-120 532-372q-30 24-69 38t-83 14q-109 0-184.5-75.5T120-580q0-109 75.5-184.5T380-840q109 0 184.5 75.5T640-580q0 44-14 83t-38 69l252 252-56 56ZM380-400q75 0 127.5-52.5T560-580q0-75-52.5-127.5T380-760q-75 0-127.5 52.5T200-580q0 75 52.5 127.5T380-400Z"/></svg></div><input aria-controls=results-container aria-expanded=false autocomplete=off id=searchInput placeholder=Search… role=combobox spellcheck=false><div class="close-icon interactive-icon" title="Clear search" id=clear-search role=button tabindex=0><svg viewbox="0 -960 960 960" xmlns=http://www.w3.org/2000/svg><path d="m256-200-56-56 224-224-224-224 56-56 224 224 224-224 56 56-224 224 224 224-56 56-224-224-224 224Z"/></svg></div></div><div id=results-container><div id=results-info><span id=zero_results> No results</span><span id=one_results> 1 result</span><span id=many_results> $NUMBER results</span><span id=two_results> $NUMBER results</span><span id=few_results> $NUMBER results</span></div><div id=results role=listbox></div></div></div></div></footer>