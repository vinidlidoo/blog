<!doctype html><html lang=ja><head><meta charset=UTF-8><meta content="default-src 'self';font-src 'self' data:;frame-src platform.twitter.com giscus.app;img-src 'self' data: pub-94e31bf482a74272bb61e9559b598705.r2.dev;media-src 'self' pub-94e31bf482a74272bb61e9559b598705.r2.dev;form-action 'self' buttondown.com formspree.io;connect-src 'self';script-src 'self' platform.twitter.com giscus.app" http-equiv=Content-Security-Policy><meta content="width=device-width,initial-scale=1.0" name=viewport><meta content=https://vinidlidoo.github.io name=base><title>
vinidlidoo • 秘密鍵の背後にある数学（第1回/全2回）</title><link href=https://vinidlidoo.github.io/img/favicon.png rel=icon type=image/png><link href="https://vinidlidoo.github.io/custom_subset.css?h=0b9535a28bc3d5bf2321" rel=stylesheet><link href="https://vinidlidoo.github.io/main.css?h=045c365e19a4d50a64bb" rel=stylesheet><link href="https://vinidlidoo.github.io/css/details.css?h=8559b4e109b168c7cfa0" rel=stylesheet><link href="https://vinidlidoo.github.io/css/giscus-fix.css?h=dc895b97fbaf0f0d9908" rel=stylesheet><link href="https://vinidlidoo.github.io/css/newsletter.css?h=c872153c9c367e0bee16" rel=stylesheet><link href="https://vinidlidoo.github.io/css/contact.css?h=572915e83e02eb90c290" rel=stylesheet><link href="https://vinidlidoo.github.io/skins/indigo_ingot.css?h=d429472afbb246441b1a" rel=stylesheet><meta content="light dark" name=color-scheme><meta content=群論から楕円曲線まで：公開鍵暗号の仕組み name=description><meta content=群論から楕円曲線まで：公開鍵暗号の仕組み property=og:description><meta content=秘密鍵の背後にある数学（第1回/全2回） property=og:title><meta content=article property=og:type><meta content=en_GB property=og:locale:alternate><link href=https://vinidlidoo.github.io/blog/math-behind-private-key/ hreflang=en rel=alternate><meta content=en_GB property=og:locale:alternate><link href=https://vinidlidoo.github.io/fr/blog/math-behind-private-key/ hreflang=fr rel=alternate><meta content=en_GB property=og:locale:alternate><link href=https://vinidlidoo.github.io/ja/blog/math-behind-private-key/ hreflang=ja rel=alternate><meta content=https://vinidlidoo.github.io/ja/blog/math-behind-private-key/ property=og:url><meta content=vinidlidoo property=og:site_name><noscript><link href=https://vinidlidoo.github.io/no_js.css rel=stylesheet></noscript><script src=https://vinidlidoo.github.io/js/initializeTheme.min.js></script><script defer src=https://vinidlidoo.github.io/js/themeSwitcher.min.js></script><body><a href=#main-content id=skip-link>Skip to content</a><header><nav class=navbar><div class=nav-title><a class=home-title href=https://vinidlidoo.github.io/ja/>vinidlidoo</a></div><div class=nav-navs><ul><li><a class="nav-links no-hover-padding" href=https://vinidlidoo.github.io/ja/blog/>blog </a><li><a class="nav-links no-hover-padding" href=https://vinidlidoo.github.io/ja/tags/>タグ </a><li><a class="nav-links no-hover-padding" href=https://vinidlidoo.github.io/ja/contact/>連絡先 </a><li class=menu-icons-container><ul class=menu-icons-group><li class=language-switcher><details class=dropdown><summary aria-label="Language selection" title="Language selection" aria-haspopup=true role=button><div class=language-switcher-icon></div></summary> <div class=dropdown-content role=menu>日本語<a aria-label=Français href=https://vinidlidoo.github.io/fr/blog/math-behind-private-key/ lang=fr role=menuitem>Français</a><a aria-label=English href=https://vinidlidoo.github.io/blog/math-behind-private-key/ lang=en role=menuitem>English</a></div></details><li class="theme-switcher-wrapper js"><div aria-label="Toggle dark mode" title="Toggle dark/light mode" aria-pressed=false class=theme-switcher role=button tabindex=0></div><div aria-label="Reset mode to default" class="theme-resetter arrow" title="Reset mode to default" aria-hidden=true role=button tabindex=0></div></ul></ul></div></nav></header><div class=content id=main-content><main><article class=h-entry><h1 class="p-name article-title">秘密鍵の背後にある数学（第1回/全2回）</h1><a class="u-url u-uid" href=https://vinidlidoo.github.io/ja/blog/math-behind-private-key/></a><ul class=meta><span class="hidden p-author h-card"> <a class=u-url href=https://vinidlidoo.github.io rel=author title=Vincent>Vincent</a> </span><li><time class=dt-published datetime=2026-01-16>16th Jan 2026</time><li title="2654 words"><span aria-hidden=true class=separator>•</span>14 min read<li class=tag><span aria-hidden=true class=separator>•</span>タグ: <li class=tag><a class=p-category href=https://vinidlidoo.github.io/ja/tags/crypto/>crypto</a>, <li class=tag><a class=p-category href=https://vinidlidoo.github.io/ja/tags/math/>math</a></ul><ul class="meta last-updated"><li><time class=dt-updated datetime=2026-01-18>Updated on 18th Jan 2026</time><li><span aria-hidden=true class=separator>•</span><a class=external href=https://github.com/vinidlidoo/vinidlidoo.github.io/commits/main/content/blog/math-behind-private-key.ja.md>See changes</a></ul><p class=p-summary hidden>群論から楕円曲線まで：公開鍵暗号の仕組み<section class="e-content body"><p><img alt=点の加算 src=/img/elliptic-curve-point-addition.png><p>楕円曲線は暗号技術のあちこちに登場する。何年も避けてきたが、Ethereumのロールアップアーキテクチャを調べているうちに、ついに立ち止まって実際に何が起きているのかを理解することにした。驚いたのは、すべてが群論の上に成り立っているということだ。大学で学んで、現実と無関係に思えてすぐに忘れてしまった、あの抽象代数だ。とんでもない思い違いだった。<p>この記事を読み終える頃には、公開鍵と秘密鍵の背後にある核心的な数学が理解できるだろう。楕円曲線からどう構築されるのか、そしてなぜその構築が安全なのか。<a href=https://vinidlidoo.github.io/ja/blog/secrets-and-signatures/>第2回</a>では、この数学が実際にどう応用されるかを扱う。<h2 id=ti-suan-shu-wobei-etashu-noji-he>体：算術を備えた数の集合</h2><p><a href=https://vinidlidoo.github.io/ja/blog/russells-paradox/>ラッセルのパラドックについての記事</a>で、集合とは何かを説明した。<strong>体</strong>とは、<strong>二項演算</strong>である加法と乗法を備え、<strong>9つの公理</strong>を満たす集合 $F$ のことだ。各演算に4つずつ、さらに両者をつなぐ分配法則で1つ。「二項」とは、各演算が2つの要素を取り、同じ集合から1つの要素を返すという意味だ。<p>$$+: F \times F \to F$$ $$\cdot: F \times F \to F$$<p>公理の例を2つ挙げる（完全なリストは<a href=https://vinidlidoo.github.io/ja/blog/math-behind-private-key/#%E4%BD%93%E3%81%AE%E5%85%AC%E7%90%86>付録</a>を参照）。<ul><li>結合法則：$(a + b) + c = a + (b + c)$<li>乗法の逆元：$\forall a \neq 0,\ \exists\ a^{-1}$ であって $a \cdot a^{-1} = 1$</ul><p>実は、体は線形代数、微積分、その他の学部数学を支えるのに必要な最小限の構造だ。実数 $\mathbb{R}$ は体を成す。有理数 $\mathbb{Q}$ も同様だ。しかし整数 $\mathbb{Z}$ は違う。$2 \cdot n = 1$ を満たす整数 $n$ は存在しない。2の乗法逆元は $\frac{1}{2}$ だが、これは $\mathbb{Z}$ に含まれない。<p>暗号技術では有限体がよく使われる。Ethereumのsecp256k1曲線は $\mathbb{F}_p$ 上で動作する。<p>$$\mathbb{F}_p = \lbrace 0, 1, 2, \ldots, p-1 \rbrace$$<p>ここで $p$ は大きな素数（$p \approx 2^{256}$）だ。算術は $p$ を法として行われる。$p = 7$ を小さな例として使うと、<ul><li>$5 + 4 = 9 \equiv 2 \pmod{7}$<li>$3 \cdot 5 = 15 \equiv 1 \pmod{7}$（つまり $3$ と $5$ は $\mathbb{F}_7$ で乗法逆元の関係にある）</ul><p>なぜ $p$ は素数でなければならないのか。$p = 6$ だと $2 \cdot 3 \equiv 0$ になる。もし $2$ に逆元 $2^{-1}$ があれば、両辺に掛けて $2^{-1} \cdot 2 \cdot 3 = 2^{-1} \cdot 0$、つまり $3 = 0$ となり、矛盾する。したがって $2$ には乗法逆元がなく、体の公理が満たされない。素数ならこの問題を回避できる。<h2 id=qun-ti-yoridan-chun-nagou-zao>群：体より単純な構造</h2><p><strong>群</strong>は体より単純な構造だ。二項演算が2つではなく1つ、公理が9つではなく4つ。群は $(G, \circ)$ と書く。$G$ は集合、$\circ$ は演算（加法、乗法、合成など何でもよい）だ。<p>4つの公理は次の通り。<ol><li><strong>閉包性</strong>：$\forall a, b \in G:\ a \circ b \in G$<li><strong>結合法則</strong>：$(a \circ b) \circ c = a \circ (b \circ c)$<li><strong>単位元</strong>：$\exists\ e \in G$ であって $e \circ a = a \circ e = a$<li><strong>逆元</strong>：$\forall a \in G,\ \exists\ a^{-1} \in G$ であって $a \circ a^{-1} = a^{-1} \circ a = e$</ol><p>公理は $G$ が何を含むか、$\circ$ が何をするかを指定しない。群一般について何かを証明すれば、それはすべての群に当てはまる。整数でも、対称性でも、曲線上の点でも。<p><strong>例</strong>：$(\mathbb{Z}, +)$（加法に関する整数）<ul><li>閉包性：$3 + 5 = 8 \in \mathbb{Z}$<li>結合法則：$(2 + 3) + 4 = 2 + (3 + 4) = 9$<li>単位元：$e = 0\ $（1ではない！）<li>逆元：$a^{-1} = -a$（$a + (-a) = 0$ だから）</ul><h2 id=tuo-yuan-qu-xian-haqun-dearu>楕円曲線は群である</h2><p>体 $\mathbb{F}_p$ 上の<strong>楕円曲線</strong>とは、次を満たす点 $(x, y)$ の集合だ。<p>$$y^2 = x^3 + ax + b$$<p>これに特別な<strong>無限遠点</strong> $\mathcal{O}$ を加える。定数 $a, b \in \mathbb{F}_p$ が曲線の形状を決める。<p>この集合は<strong>点の加算</strong>と呼ばれる二項演算の下で群を成す。この構成は恣意的に見えるかもしれないが、まさにこれが群の公理を満たすのに必要な定義だ。仕組みはこうだ。<ol><li>$P$ と $Q$ を通る直線を求める（つまり $y = mx + c$ の傾き $m$ と切片 $c$ を解く）。$P = Q$ の場合は $P$ での接線を使う。<li>この直線は曲線とちょうど3点で交わる（重複度を数える。接線は2回分）。3番目の交点 $R$ を求める。<li>結果を計算する。 <ul><li><strong>$R$ が有限点の場合</strong>：x軸に関して反転し、$P + Q = -R$ を得る。ここで $-R = (x, -y)$。<li><strong>直線が垂直の場合</strong>：有限の3番目の交点がない。結果は無限遠点 $\mathcal{O}$ になる。</ul></ol><p>もう1つのルール：任意の点 $P$ について $P + \mathcal{O} = P$。無限遠点は単位元として機能する。<p>群の公理の検証：<ul><li><strong>閉包性</strong>：点の加算は常に曲線上の別の点（または $\mathcal{O}$）を与える<li><strong>結合法則</strong>：成り立つ（証明は非自明）<li><strong>単位元</strong>：上で定義した $\mathcal{O}$<li><strong>逆元</strong>：$(x, y)$ の逆元は $(x, -y)$（和が $\mathcal{O}$ になるから）</ul><h2 id=nazean-hao-xue-zhe-gazhu-mu-surunoka>なぜ暗号学者が注目するのか</h2><p>これで群ができた。楕円曲線上の点、加算演算、4つの公理が満たされている。しかし群は数学のあらゆるところにある。<em>この</em>群が暗号に役立つのはなぜか。<p>答えは非対称性にある。この群上のある操作は計算が簡単だが、逆方向は事実上不可能だ。これを理解するには、もう1つの概念が必要だ。<p><strong>スカラー倍</strong>は加算の繰り返しだ。群演算があるので、繰り返し適用できる。$nP$ は $P$ を $n$ 回足すことを意味する。<p>$$nP = \underbrace{P + P + \cdots + P}_{n \text{ 回}}$$<p>暗号のセキュリティには大きな数が必要だ。Ethereumは $n \approx 2^{256}$（78桁の数）を使う。素朴に $nP$ を計算すると $n - 1$ 回の加算が必要で、これは不可能だ。<p>しかし、どんな整数も二進表現を持つ。$n = 13$ を例にとると、<p>$$13 = 1101_2 = 8 + 4 + 1$$<p>したがって $13P = 8P + 4P + P$。重要な洞察は $8P = 2(4P) = 2(2(2P))$ だ。$2P$、$4P$、$8P$ を繰り返し倍算で計算し（3回の演算）、関連する項を足す（さらに2回）。合計：12回ではなく5回の演算。<p>これが<strong>ダブル・アンド・アッド</strong>（double-and-add）だ。任意の $n$ に対して $O(\log n)$ 回の演算で済み、$n$ のビット数程度だ。$n \approx 2^{256}$ でも、約256回の倍算と加算で済む。高速だ。<p><strong>逆方向は難しい。</strong> $P$ と $Q = nP$ が与えられたとき、$n$ を求めるのが<strong>離散対数問題</strong>（DLP）だ。「対数」は $b^n = x \Rightarrow n = \log_b(x)$ との類推から。「離散」は有限群だから。<p>総当たりより大幅に速いアルゴリズムは知られていない。$n \approx 2^{256}$ では、これは実行不可能だ。<p><strong>この非対称性こそが公開鍵暗号に必要なものだ。</strong> 各曲線仕様には、全員が使う標準的な基点 $P$（ジェネレーターとも呼ばれる）が含まれている。<ul><li>秘密の整数 $n$ を選ぶ。これが<strong>秘密鍵</strong>。<li>$Q = nP$ を計算する。これが<strong>公開鍵</strong>。<li>$Q$ を公開する。署名や暗号化のプロトコルはこの鍵ペアの上に構築される。<li>あなたになりすますには、攻撃者は $Q$ と $P$ から $n$ を復元しなければならない。しかしそれはDLPであり、実行不可能だ。</ul><p>これが楕円曲線暗号の核心だ。実際の実装にはさらなる層がある。Ethereumは公開鍵をハッシュしてアドレスを導出し、ECDSAのような署名方式には追加のステップがある。しかし、そのすべてのセキュリティはDLPの困難さに依存している。<h2 id=matome>まとめ</h2><p>多くの内容を扱った。体は有限空間での算術を与える。群はより単純な構造（1つの演算、4つの公理）で、あらゆるところに現れる。楕円曲線は点の加算の下で群を成し、これらの曲線上の離散対数問題は秘密鍵を守るのに十分難しい。<p>構成はエレガントだ。秘密の数 $n$ を選び、既知の点 $P$ をそれで掛け、結果 $Q = nP$ を公開する。誰でも $Q$ を使って検証できるが、$n$ を復元するのは計算上は手の届かないところにある。<a href=https://vinidlidoo.github.io/ja/blog/secrets-and-signatures/>第2回</a>では、この基盤が2つの実用的なプロトコルをどう可能にするかを見る。鍵交換のためのECDHと、デジタル署名のためのECDSAだ。<hr><p><a id=体の公理></a><h2 id=fu-lu-ti-nogong-li>付録：体の公理</h2><details><summary>9つの公理</summary> <p><strong>加法の公理</strong>（すべての $a, b, c \in F$ について）：</p> <ol><li><strong>結合法則</strong>：$(a + b) + c = a + (b + c)$<li><strong>交換法則</strong>：$a + b = b + a$<li><strong>単位元</strong>：$\exists\ 0 \in F$ であって $a + 0 = a$<li><strong>逆元</strong>：$\exists\ (-a) \in F$ であって $a + (-a) = 0$</ol> <p><strong>乗法の公理</strong>（すべての $a, b, c \in F$ について）：</p> <ol start=5><li><strong>結合法則</strong>：$(a \cdot b) \cdot c = a \cdot (b \cdot c)$<li><strong>交換法則</strong>：$a \cdot b = b \cdot a$<li><strong>単位元</strong>：$\exists\ 1 \in F$ であって $a \cdot 1 = a$<li><strong>逆元</strong>：$\forall a \neq 0,\ \exists\ a^{-1} \in F$ であって $a \cdot a^{-1} = 1$</ol> <p><strong>加法と乗法をつなぐ公理</strong>：</p> <ol start=9><li><strong>分配法則</strong>：$a \cdot (b + c) = a \cdot b + a \cdot c$</ol></details><hr></section><p class=credit><em>この記事は<a href=https://claude.ai>Claude</a>と協力して執筆しました。</em><form action=https://buttondown.com/api/emails/embed-subscribe/vinidlidoo class=embeddable-buttondown-form method=post target=_blank><label for=bd-email>新着記事の通知はこちらから。</label><input id=bd-email name=email placeholder=your@email.com type=email><input type=submit value=登録></form></article></main><link href=https://vinidlidoo.github.io/katex.min.css rel=stylesheet><script defer src=https://vinidlidoo.github.io/js/katex.min.js></script><span class=hidden id=copy-success> Copied! </span><span class=hidden id=copy-init> Copy code to clipboard </span><script defer src=https://vinidlidoo.github.io/js/copyCodeToClipboard.min.js></script></div><footer><section><nav class="socials nav-navs"><ul><li><a class="nav-links no-hover-padding social" rel=" me" href=https://github.com/vinidlidoo> <img alt=github loading=lazy src=https://vinidlidoo.github.io/social_icons/github.svg title=github> </a><li><a class="nav-links no-hover-padding social" rel=" me" href=https://x.com/vinidlidoo> <img alt=x loading=lazy src=https://vinidlidoo.github.io/social_icons/x.svg title=x> </a></ul></nav><nav class=nav-navs></nav><div class=credits><small> <p><p>© 2026 Vincent Ethier</p> Powered by <a href=https://www.getzola.org>Zola</a> & <a href=https://github.com/welpo/tabi>tabi</a> </small></div></section></footer>